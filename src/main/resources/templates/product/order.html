<!DOCTYPE html>
<!-- xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.thymeleaf.org/"
        xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6" -->

<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>롯데ON::롯데 온라인 쇼핑몰</title>
    <!-- 파비콘 -->
    <link rel="shortcut icon" type="image/x-icon" href="../images/favicon.ico"/>
    <link rel="stylesheet" th:href="@{/css/product/product_common.css}"/>
    <link rel="stylesheet" th:href="@{/css/product/style_product_order.css}"/>
    <script>
        window.onload = function () {
            const addPoint = document.getElementById("addPoint");
            const allPoint = document.getElementById("allPoint");
            const nowPoint = document.getElementById("nowPoint");

            let maxPoint = parseInt(nowPoint.innerText) || 0;

            addPoint.addEventListener('input', function (){
                let usedPoint = parseInt(addPoint.value) || 0;

                if (usedPoint < 0) {
                    usedPoint = 0;
                    addPoint.value = 0; // 입력값도 0으로 수정
                }

                // 사용 포인트가 현재 포인트보다 클 경우 최대 포인트로 제한
                if (usedPoint > maxPoint) {
                    usedPoint = maxPoint;
                    addPoint.value = maxPoint; // 입력값도 최대 포인트로 수정
                }

                // 남은 포인트 동적으로 업데이트
                nowPoint.innerText = (maxPoint - usedPoint) + 'p';
            });

            allPoint.addEventListener('click', function (){
                if (confirm("전체 사용하시겠습니까?")){
                    alert("전체 사용을 선택하셨습니다.")
                    addPoint.value = maxPoint;
                    nowPoint.innerText = '0p';
                } else{
                    alert("취소하셨습니다.")
                }
            });
        }

    </script>
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>

</head>
<body>
<div id="bannerTop" class="on">
    <article th:each="banner : ${banners}" th:if="${banner.location == 'MAIN1'}" th:style="'background: ' + ${banner.background}">
        <a th:href="${banner.link}">
            <img th:src="@{'/uploads/' + ${banner.img}}" alt="랜덤 배너 이미지"/>
        </a>
    </article>
</div>
<div id="wrapper">
    <header th:replace="~{/include/header.html}"></header>

    <main class="mainIn cf">
        <aside th:replace="~{/main_aside.html}"></aside>


        <!-- 주문하기 영역 -->
        <section class="cart-section">

            <!-- Breadcrumb -->
            <div class="breadcrumb">
                <a href="#">Home</a> &gt;
                <a href="#">장바구니</a> &gt;
                <a href="#">주문하기</a>
                <section class="order-section">
            </div>
            <!-- 주문하기 제목 -->
            <h2 class="section-title">주문하기</h2>
            <!-- 주문 상품목록 -->
            <div class="cart-">
                <table class="cart-table">
                    <thead>
                    <tr>
                        <th>상품정보</th>
                        <th>판매가</th>
                        <th>수량</th>
                        <th>구매가</th>
                        <th>배송정보</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="product-info">
                            <img src="/images/product/image2.png" alt="상품 이미지">
                            <div class="product-details">
                                <p class="product-name">[브랜드] 상품명</p>
                            </div>
                        </td>
                        <td>33,000원</td>
                        <td>
                            <div class="quantity">
                                <p>1</p>
                            </div>
                        </td>
                        <td>
                            <div class="price-info">
                                <del>33,000원</del>
                                <span class="discount-price">23,760원</span>
                            </div>
                        </td>
                        <td class="shipping-info">무료배송</td>
                    </tr>
                    </tbody>
                </table>
            </div> <!--cart--->

            <div class="forDiv">
                <section class="order-right">
                    <aside class="coupon-section">

                        <table class="form-group">
                            <th><p class="tableTitle">할인 정보</p></th>
                            <tr>
                                <th>현재포인트 : </th>
                                <td>
                                    <span id="nowPoint">7200p</span>
                                </td>
                            </tr>
                            <tr>
                                <th>사용포인트 : </th>
                                <td>
                                    <div style="display: flex;">
                                        <input type="number" id="addPoint" step="1000" style="width: 80%;">
                                        <button id="allPoint">전체<br>사용</button>
                                    </div>
                                    <p style="text-align: center; font-size: 10px" >포인트 5000p 미만 사용불가</p>
                                </td>
                            </tr>
                            <tr>
                                <th>쿠폰선택</th>
                                <td>
                                    <select name="etc" id="condition" >
                                        <option value="condition">[브랜드] 10000원 쿠폰</option>
                                    </select>
                                </td>
                            </tr>
                        </table>
                    </aside>
                    <!-- 최종 결제 금액-->
                    <aside class="checkout-summary">
                        <div class="checkout-details">
                            <table class="checkout-row">
                                <th><p class="tableTitle">최종 결제</p></th>
                                <tr class="checkout-column">
                                    <th>총 판매가</th>
                                    <td>33,000원</td>
                                </tr>
                                <tr class="checkout-column">
                                    <th>총 할인금액</th>
                                    <td class="discount">9,240원</td>
                                </tr>
                                <tr class="checkout-column">
                                    <th>배송비</th>
                                    <td>0원</td>
                                </tr>
                                <tr class="checkout-price">
                                    <th>총 결제 금액</th>
                                    <td>23,760원</td>
                                </tr>
                            </table>
                        </div>
                        <a th:href="@{/product/complete}" type="submit" class="checkout-btn">결제하기</a>
                    </aside>
                </section> <!-- order-right -->
            </div>
            <!-- 배송 정보 -->
            <section class = "order-left">
                <div class="shipping-section">
                    <form>
                        <table class="shipping-table">
                            <th> <p class="tableTitle">배송 정보</p></th>
                            <tr>
                                <th>수령자</th>
                                <td>
                                    <input type=text value="수령자"/>
<!--                                    이부분 추후에 개발 여부 확인 <button type="button">동일인</button>-->
                                </td>
                            </tr>
                            <tr>
                                <th>휴대폰</th>
                                <td>
                                    <input type=text  id="phone-number" value="휴대폰"/>
                                </td>
                            </tr>
                            <tr>
                                <th>우편번호</th>
                                <td>
                                    <input type="text" id="postcode" name="postcode" required>
                                    <button type="button" id="findPostcodeBtn">검색</button>
                                    <script>
                                        var findPostcodeBtn = document.getElementById("findPostcodeBtn");
                                        findPostcodeBtn.onclick = function() {
                                            new daum.Postcode({
                                                oncomplete: function(data) {
                                                    document.getElementById('postcode').value = data.zonecode;
                                                    document.getElementById('address').value = data.roadAddress || data.jibunAddress;
                                                    document.getElementById('detailAddress').focus();
                                                }
                                            }).open();
                                        };
                                    </script>
                                </td>
                            </tr>
                            <tr>
                                <th>기본주소</th>
                                <td>
                                    <input type="text" id="address" name="address" required>
                                </td>
                            </tr>
                            <tr>
                                <th>상세주소</th>
                                <td>
                                    <input type="text" id="detailAddress" name="detailAddress" required>
                                </td>
                            </tr>
                            <tr>
                                <th>배송 메시지</th>
                                <td>
                                    <textarea class="delivery__text"></textarea>
                                </td>
                            </tr>

                            <th><p class="tableTitle">결제 정보</p></th>
                            <tr>
                                <th>결제방법</th>
                                <td class ="radio">
                                    <label>
                                        <input type="radio" name="paymentMethod" th:checked="${deliveryfee == 2000}"/> 카카오페이
                                    </label>
                                    <label>
                                        <input type="radio" name="paymentMethod" th:checked="${deliveryfee == 3000}"/> 토스
                                    </label>
                                    <label>
                                        <input type="radio" name="paymentMethod" th:checked="${deliveryfee == 5000}"/> 페이코</br>
                                    </label>
                                    <label>
                                        <input type="radio" name="paymentMethod" th:checked="${deliveryfee == 0}"/> 무통장입금
                                    </label>
                                    <label>
                                        <input type="radio" name="paymentMethod" th:checked="${deliveryfee == 0}"/> 네이버페이
                                    </label>
                                </td>
                            </tr>
                        </table>
                    </form>
                </div><!-- shipping-section-->
            </section><!-- order-left -->

        </section>
        </section>
    </main>
    <footer th:replace="~{/include/footer.html}"></footer>
    <button type="button" id="top">상단이동</button>
</div>
</body>
</html>
