<!DOCTYPE html>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<html lang="ko"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
      xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>회원목록</title>

    <link rel="stylesheet" th:href="@{/css/admin/style_admin_common.css}" />
    <link rel="stylesheet" th:href="@{/css/admin/style_admin_member_list.css}" />
  </head>
  <body>
  <header th:replace="~{/admin/include/header.html}"></header>
    <main>
      <div id="wrapper">
        <aside th:replace="~{/admin/include/aside.html}"></aside>
        <section>
          <div class="breadcrumb">
            <a href="#">Home</a> > <a href="#">회원관리</a> >
            <a href="#" class="location">회원목록</a>
          </div>
          <h3>회원목록</h3>
          <div class="form">
            <div class="search-bar">
              <form action="#" th:action="@{/admin/member/list}" method="get"> <!-- GET 방식으로 폼 전송 -->
                <select id="search-category" name="searchCategory" class="dropdown"> <!-- name 속성 추가 -->
                  <option value="uid" th:selected="${searchCategory == 'uid'}">아이디</option>
                  <option value="name" th:selected="${searchCategory == 'name'}">이름</option>
                  <option value="email" th:selected="${searchCategory == 'email'}">이메일</option>
                  <option value="hp" th:selected="${searchCategory == 'hp'}">휴대폰</option>
                </select>
                <input
                        type="text"
                        name="keyword"
                        placeholder="키워드 입력"
                        class="search-input"
                        th:value="${keyword}"
                />
                <button type="submit" class="search-btn">검색</button> <!-- type을 submit으로 설정 -->
              </form>
            </div>


            <table class="inquiry-table">
              <colgroup>
                <col style="width: 5%" />
                <col style="width: 7%" />
                <col style="width: 6%" />
                <col style="width: 5%" />
                <col style="width: 6%" />
                <col style="width: 6%" />
                <col style="width: 13%" />
                <!--<col style="width: 9%" />-->
                <col style="width: 10%" />
                <col style="width: 5%" />
                <col style="width: 7%" />
              </colgroup>
              <thead>
                <tr>
                  <th>번호</th>
                  <th>아이디</th>
                  <th>이름</th>
                  <th>성별</th>
                  <th>등급</th>
                  <th>포인트</th>
                  <th>이메일</th>
                  <!--<th>휴대폰</th>-->
                  <th>가입일</th>
                  <th>상태</th>
                  <th>관리</th>
                </tr>
              </thead>
              <tbody>
              <tr th:each="user, i : ${userList}">
                <td th:text="${startNo - i.index}"></td> <!-- 번호 역순 출력 -->
                <td>[[${user.uid}]]</td>
                  <td>[[${user.memberInfo.name}]]</td>
                  <td>[[${user.memberInfo.gender == 0 ? 'M' : 'F'}]]</td>
                <td>
                  <select name="grade" class="grade">
                    <option value="VVIP" th:selected="${user.memberInfo.grade == 'VVIP'}">VVIP</option>
                    <option value="VIP" th:selected="${user.memberInfo.grade == 'VIP'}">VIP</option>
                    <option value="GOLD" th:selected="${user.memberInfo.grade == 'GOLD'}">GOLD</option>
                    <option value="SILVER" th:selected="${user.memberInfo.grade == 'SILVER'}">SILVER</option>
                    <option value="FAMILY" th:selected="${user.memberInfo.grade == 'FAMILY'}">FAMILY</option>
                  </select>
                </td>

                <td>[[${user.memberInfo.point}]]</td>
                  <td>[[${user.memberInfo.email}]]</td>
                  <!--<td>[[${user.memberInfo.hp}]]</td>-->
                <td th:text="${#strings.substring(user.memberInfo.updatedAt, 0, 19)}"></td>

                <!--                  글자 색상 스크립트 처리? or th:if-->
                  <td class="userStatus normal">[[${user.memberInfo.status}]]</td>
                  <td>
                    <a href="#" id="registerModalBtn" class="edit-btn">수정</a><br />
<!--                     중지 / 재개 / 비활성 스크립트 처리 or th:if -->
                    <button class="deletebtn">중지</button>
                  </td>
                </tr>
              </tbody>
            </table>
            <div class="pagination">
              <button class="page-btn"
                      th:disabled="${currentPage == 0}"
                      th:onclick="'window.location.href=\'?page=' + ${currentPage - 1} + '&size=5\''">
                이전
              </button>
              <span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
                        <button class="page-num"
                                th:classappend="${i == currentPage} ? 'active'"
                                th:onclick="'window.location.href=\'?page=' + ${i} + '&size=5\''"
                                th:text="${i + 1}">1</button>
                    </span>
              <button class="page-btn"
                      th:disabled="${currentPage + 1 == totalPages}"
                      th:onclick="'window.location.href=\'?page=' + ${currentPage + 1} + '&size=5\''">
                다음
              </button>
            </div>
          </div>
        </section>
      </div>
    </main>
    <div id="versionRegisterModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h4>배너등록</h4>
          <span id="registerModalClose" class="close">&times;</span>
        </div>
        <div class="modal-body">
          <form id="versionRegisterForm">
            <table class="modal-table">
              <tr>
                <th>아이디</th>
                <td>
                  <input
                    type="text"
                    id="userId"
                    placeholder="#유저아이디"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>이름</th>
                <td>
                  <input
                    type="text"
                    id="userName"
                    placeholder="#유저이름"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>성별</th>
                <td>
                  <input type="radio" class="modal_sex" name="sex" />남
                  <input type="radio" class="modal_sex" name="sex" />여
                </td>
              </tr>
              <tr>
                <th>등급</th>
                <td>
                  <input
                    type="text"
                    id="userGrade"
                    placeholder="#유저등급"
                    required
                  />
                  등급 수정은 회원 목록에서 선택수정 가능
                </td>
              </tr>
              <tr></tr>
              <tr>
                <th>상태</th>
                 상태마다 글자 색 변경 필요 
                <td>정상</td>
              </tr>
              <tr>
                <th>EMAIL</th>
                <td>
                  <input
                    type="text"
                    id="userEmail"
                    placeholder="#유저이메일"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>휴대폰</th>
                <td>
                  <input
                    type="text"
                    id="userHp"
                    placeholder="#유저휴대폰"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>우편번호</th>
                <td>
                  <input
                    type="text"
                    id="userPost"
                    placeholder="#유저우편번호"
                    required
                  />
                    <a href="#" style="color: green">검색</a>
                </td>
              </tr>
              <tr>
                <th>기본주소</th>
                <td>
                  <input
                    type="text"
                    id="userAddr1"
                    placeholder="#유저기본주소"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>상세주소</th>
                <td>
                  <input
                    type="text"
                    id="userAddr2"
                    placeholder="#유저상세주소"
                    required
                  />
                </td>
              </tr>
              <tr>
                <th>가입일</th>
                <td>유저가입일</td>
              </tr>
              <tr>
                <th>최근로그인날짜</th>
                <td>최근로그인날짜</td>
              </tr>
              <tr>
                <th>기타</th>
                <td>
                  <textarea
                    name="etc"
                    id="etc"
                    placeholder="회원에대한기타정보입력"
                  ></textarea>
                </td>
              </tr>
            </table>
          </form>
        </div>
        <div class="modal-footer">
          <button class="confirm-btn">등록하기</button>
        </div>
      </div>
    </div>
  <footer th:replace="~{/admin/include/footer.html}"></footer>
  </body>
</html>
<script>
  // 버전확인 모달 동작
  document.addEventListener('DOMContentLoaded', function() {
    var modal = document.getElementById("versionModal");
    var btns = document.querySelectorAll(".edit-btn"); // "확인" 버튼들
    var versionCloseBtn = document.getElementById("versionModalClose"); // 버전 모달 닫기 버튼
    var closeButton = document.getElementById("versionCloseBtn");

    // "확인" 버튼 클릭 시 모달 열기
    btns.forEach(function(btn) {
      btn.onclick = function() {
        modal.style.display = "block";
      };
    });

    // 닫기 버튼(X) 클릭 시 모달 닫기
    versionCloseBtn.onclick = function() {
      modal.style.display = "none";
    };

    // 하단 닫기 버튼 클릭 시 모달 닫기
    closeButton.onclick = function() {
      modal.style.display = "none";
    };

    // 모달 외부 클릭 시 모달 닫기
    window.onclick = function(event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    };
  });

  // 버전 등록 모달 동작
  document.addEventListener('DOMContentLoaded', function() {
    var registerModal = document.getElementById("versionRegisterModal");
    var registerBtn = document.getElementById("registerModalBtn"); // 등록 버튼
    var registerCloseBtn = document.getElementById("registerModalClose"); // 등록 모달 닫기 버튼
    var closeButton = document.getElementById("registerCloseBtn"); // 하단 닫기 버튼
    var confirmButton = document.getElementById("registerConfirmBtn");

    // 등록 버튼 클릭 시 모달 열기
    registerBtn.onclick = function() {
      registerModal.style.display = "flex";
    };

    // 닫기 버튼(X) 클릭 시 모달 닫기
    registerCloseBtn.onclick = function() {
      registerModal.style.display = "none";
    };

    // 하단 닫기 버튼 클릭 시 모달 닫기
    closeButton.onclick = function() {
      registerModal.style.display = "none";
    };

    // 모달 외부 클릭 시 모달 닫기
    window.onclick = function(event) {
      if (event.target == registerModal) {
        registerModal.style.display = "none";
      }
    };

    // 등록 확인 버튼 클릭 시
    confirmButton.onclick = function() {
      var version = document.getElementById("versionInput").value;
      var changelog = document.getElementById("changelogInput").value;

      if (version && changelog) {
        // 등록 로직 추가 (서버 전송 또는 콘솔 출력)
        console.log("버전:", version);
        console.log("변경내역:", changelog);

        // 등록 완료 후 모달 닫기
        registerModal.style.display = "none";
      } else {
        alert("모든 필드를 입력해주세요.");
      }
    };
  });


</script>
